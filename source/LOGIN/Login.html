<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Sửa đường dẫn CSS -->
    <link rel="stylesheet" href="Login.css" />
    <link rel="stylesheet" href="../HEADER-FOOTER/Footer.css" />
    <link rel="stylesheet" href="../HEADER-FOOTER/Header.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <title>LOGIN</title>
  </head>
  <body>
    <div class="container-fluid cart-container">
      <div id="header-placeholder"></div>
      <script>
        $(function () {
          $("#header-placeholder").load("../HEADER-FOOTER/Header.html");
          $("#footer-placeholder").load("../HEADER-FOOTER/Footer.html");
        });
      </script>

      <div class="row">
        <div class="col-md-6">
          <!-- Login Section -->
          <div class="login-section">
            <h1>ĐĂNG NHẬP</h1>
            <div id="login-message" style="color: red"></div>

            <div class="forgot-password">
              <a href="../REGISTER/Register.html">Bạn chưa có tài khoản ?</a>
            </div>

            <form id="loginForm">
              <div class="mb-3">
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  name="email"
                  placeholder="Email"
                  required
                />
              </div>

              <div class="mb-3 position-relative">
                <input
                  type="password"
                  class="form-control"
                  id="password"
                  name="password"
                  placeholder="Mật khẩu"
                  required
                />
                <span
                  id="togglePassword"
                  style="
                    position: absolute;
                    top: 50%;
                    right: 15px;
                    transform: translateY(-50%);
                    cursor: pointer;
                    z-index: 2;
                  "
                >
                  <i class="fa fa-eye" id="eyeIcon"></i>
                </span>
              </div>

              <!--Quên mật khẩu-->
              <div class="forgot-password1" style="margin-bottom: 10px">
                <a href="" id="forgot-password-link">Quên mật khẩu?</a>
              </div>

              <p class="login-note">
                <input
                  type="checkbox"
                  id="remember"
                  name="remember"
                  class="form-check-input"
                />
                Giữ đăng nhập - áp dụng cho tất cả các tùy chọn đăng nhập dưới
                đây
              </p>

              <button type="submit" class="btn login-btn">ĐĂNG NHẬP</button>
            </form>

            <div class="divider">
              <hr />
              <span>Hoặc</span>
              <hr />
            </div>

            <button
              onclick="window.location.href='google-login.php'"
              class="google-login-btn"
            >
              <img
                src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
                alt="Google Logo"
              />
              <span>Đăng nhập với Google</span>
            </button>

            <p class="login-note">
              Bằng cách nhấn "Đăng nhập", bạn đồng ý với
              <a href="../POLICY/policy.html" target="_blank"
                >Điều khoản và Điều kiện</a
              >
              của Len Lab.
            </p>
          </div>
        </div>

        <div class="col-md-6">
          <!-- Club Section -->
          <div class="club-section">
            <h1>Tham gia LenLab Club và nhận thưởng ngay hôm nay.</h1>

            <p class="club-description">
              Là thành viên LenLab Club, bạn sẽ được nhận những phần thưởng yêu
              thích khi làm điều bạn yêu thích. Đăng ký ngay hôm nay để nhận
              ngay các quyền lợi Cấp 1 sau:
            </p>

            <ul class="benefits-list">
              <li>Miễn phí giao hàng</li>
              <li>Phiếu giảm giá 15% cho lần mua tiếp theo</li>
              <li>Ưu đãi và khuyến mãi đặc biệt</li>
            </ul>

            <p class="club-description">
              Tham gia ngay để bắt đầu tích điểm, nâng cấp hạng và mở khóa thêm
              nhiều phần thưởng cùng ưu đãi từ LenLab Club.
            </p>

            <button id="join-btn" class="btn join-btn">THAM GIA</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Popup form nhập email reset -->
    <div
      class="modal fade"
      id="forgotPasswordModal"
      tabindex="-1"
      aria-labelledby="forgotPasswordModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <form id="forgotPasswordForm">
            <div class="modal-header">
              <h5
                class="modal-title"
                id="forgotPasswordModalLabel"
                style="text-align: center; font-weight: bold; color: #e56332"
              >
                Quên mật khẩu
              </h5>

              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Đóng"
              ></button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label for="reset-email" class="form-label"
                  >Nhập email để đặt lại mật khẩu:</label
                >
                <input
                  type="email"
                  class="form-control"
                  id="reset-email"
                  name="reset-email"
                  required
                />
              </div>
              <div id="reset-message" style="color: red"></div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-primary">Gửi</button>
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Hủy
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        // Xử lý gửi form đăng nhập
        $("#loginForm").submit(function (e) {
          e.preventDefault();
          $.post(
            "Login.php",
            $(this).serialize(),
            function (response) {
              $("#login-message").html(response.message);
              $("#loginForm")[0].reset();
              if (response.status === "success") {
                if (response.is_admin) {
                  window.location.href =
                    "../ADMIN/DASHBOARD/Trang tổng quan.html";
                } else {
                  window.location.href = "../LANDING-PAGE/landingpage.html";
                }
              }
            },
            "json"
          ).fail(function () {
            alert(
              "Đã xảy ra lỗi trong quá trình đăng nhập. Vui lòng thử lại !"
            );
            $("#loginForm")[0].reset();
          });
        });

        // Xử lý gửi nhấn nút "Tham gia"
        $("#join-btn").click(function (e) {
          e.preventDefault();
          window.open(
            "https://www.facebook.com/profile.php?id=61575666167762&sk=about",
            "_blank"
          );
        });
      });

      // Khi người dùng nhấn "Quên mật khẩu?" thì mở popup
      $("#forgot-password-link").click(function (e) {
        e.preventDefault();
        const modal = new bootstrap.Modal(
          document.getElementById("forgotPasswordModal")
        );
        modal.show();
      });

      $("#forgot-password-link").click(function (e) {
        e.preventDefault();
        $("#forgotPasswordModal").modal("show");
      });

      // Xử lý gửi form quên mật khẩu
      $("#forgotPasswordForm").submit(function (e) {
        e.preventDefault();
        var email = $("#reset-email").val();
        // Gửi AJAX tới server để xử lý reset (bạn cần tạo endpoint phù hợp)
        $.post(
          "ForgotPassword.php",
          { email: email },
          function (response) {
            $("#reset-message").css(
              "color",
              response.status === "success" ? "green" : "red"
            );
            $("#reset-message").text(response.message);
            if (response.status === "success") {
              setTimeout(function () {
                $("#forgotPasswordModal").modal("hide");
                $("#reset-message").text("");
                $("#forgotPasswordForm")[0].reset();
              }, 1500);
            }
          },
          "json"
        ).fail(function () {
          $("#reset-message")
            .css("color", "red")
            .text("Có lỗi xảy ra. Vui lòng thử lại!");
        });
      });

      $("#togglePassword").on("click", function () {
        const passwordInput = $("#password");
        const eyeIcon = $("#eyeIcon");
        const type =
          passwordInput.attr("type") === "password" ? "text" : "password";
        passwordInput.attr("type", type);
        eyeIcon.toggleClass("fa-eye fa-eye-slash");
      });
    </script>

    <div id="footer-placeholder"></div>
    <script>
      // Tải nội dung Footer vào phần tử #footer-placeholder
      $(function () {
        $("#footer-placeholder").load("../HEADER-FOOTER/Footer.html");
      });
    </script>
  </body>
</html>
